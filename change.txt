# 斷線測試

const socket = io({
    reconnection: true,
    reconnectionAttempts: 5,
    reconnectionDelay: 1000
});
window.socket = socket;

    socket.on('connect', function () {
        console.log('連接成功');
        window.socket.connected = true;
        isConnected = true;
    });

        socket.on('disconnect', function () {
        console.log('連接斷開');
        window.socket.connected = false;
        isConnected = false;
    });

# 無障礙測試

<body>
    <header>
        <div class="chat-header" id="chat-header">
            <h1>CHAT</h1>
            <div class="online-status">online</div>
        </div>
    </header>

    <main class="chat-container">
        <div class="online-counter hidden" id="onlineCounter" onclick="toggleUsersPanel()">
            <span id="onlineCount">0</span> 
        </div>

        <section class="username-container" id="usernameContainer" aria-label="輸入暱稱區域">
            <div class="username-form">
                <label for="usernameInput">暱稱</label>
                <input type="text" id="usernameInput" placeholder="請輸入您的暱稱..." maxlength="20">
                <button onclick="joinChat()">加入聊天</button>
            </div>
        </section>

        <section class="messages hidden" id="messages" aria-label="訊息列表"></section>
        <div class="typing-indicator" id="typingIndicator"></div>

        <section class="message-input-container hidden" id="messageContainer" aria-label="訊息輸入區域">
            <div class="input-buttons">
                <button onclick="handleImageSelect()" class="image-button" id="imageButton" title="發送圖片"></button>
            </div>
            <label for="messageInput" class="visually-hidden">訊息內容</label>
            <textarea id="messageInput" class="message-input" placeholder="輸入消息..." maxlength="500" rows="1"></textarea>
            <div class="input-buttons">
                <button onclick="sendMessage()" class="send-button" id="sendButton" title="發送消息"></button>
            </div>
            <input type="file" id="imageInput" accept="image/*" style="display: none;">
            <div class="drag-hint">拖曳圖片到此處發送</div>
        </section>
    </main>

    <div class="users-panel-overlay" id="usersPanelOverlay" onclick="closeUsersPanel()"></div>

    <aside class="users-panel" id="usersPanel" role="complementary" aria-label="在線用戶清單">
        <div class="users-panel-header">
            <h2 class="users-panel-title">在線用戶</h2> <!-- ← 原 h3 改為 h2 -->
            <button class="users-panel-close" onclick="closeUsersPanel()">&times;</button>
        </div>
        <div class="users-list" id="usersList">
            <!-- 用户列表将通过JavaScript动态生成 -->
        </div>
    </aside>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.0.1/socket.io.js"></script>
    <script src="static/js/chat.js"></script>
</body>

# ui 

圖片測試
拖曳圖片
使用者加入離開

TDD
    UI
    頁面加載
    加入聊天
    發送消息
    防止空消息發送
    加入離開 顯示在聊天室
    多用戶消息顯示在UI
    拖曳/加入 圖片
    計數器正確顯示
    電腦/手機介面顯示差異

    後端
    消息發送
    用戶加入
    多用戶聊天
    用戶加入斷開
    消息數量限制
    圖片格式設定
    斷線重連

    無障礙測試
    是否符合WCAG AA 合規
    color-contrast → 文字/背景對比
    image-alt → <img> 缺 alt
    label → 輸入框沒 <label> 或 aria-label
    aria-roles → 對話框、側欄缺正確角色
    keyboard → 元素無法用 Tab 聚焦或 Enter 觸發

    安全測試
    xss attack
    惡意文件測試
    惡意輸入測試
    chat room 維護 -> 重複用戶名 / 斷開後會話清理
    消息洪流

    效能測試
    多用戶多則消息 覆蓋率
    連接穩定覆蓋率
    響應時間大小

TODO
    Replay 攻擊防禦（訊息重播）
        目的：檢查後端是否阻止重播舊封包？
    長時間連線穩定性（心跳）
        目的：1 小時以上連線，是否保持穩定？
    記憶體／資源洩漏（browser / server）
        目的：暴力測試前端與後端是否有記憶體爆漲或 socket 泄漏

